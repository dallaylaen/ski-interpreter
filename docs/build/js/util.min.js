"use strict";(()=>{var l=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var d=l((et,y)=>{"use strict";function O(...n){let t={};for(let e of n)t[e]=document.getElementById(e);return t}function U(n,t,e={}){let i=document.createElement(t);return e.class&&i.classList.add(...e.class),e.content!==void 0&&(i.innerHTML=""+e.content),e.hidden&&(i.hidden=!0),e.color&&(i.style.color=e.color),n&&n.appendChild(i),i}function j(n){typeof n!="string"&&(n=""+n);let t={"<":"&lt;",">":"&gt;","&":"&amp;"};return n.replace(/[<>&]/g,e=>t[e])}function z(n){let t={"(":"%28",")":"%29"};return encodeURIComponent(n).replace(/[()]/g,e=>t[e]).replace(/%20/g,"+")}function V(n){return decodeURIComponent((""+n).replace(/\+/g," "))}y.exports={append:U,decode:V,encode:z,grabView:O,sanitize:j}});var L=l((it,b)=>{"use strict";var{append:p}=d(),m=class{constructor(t={}){this.options=t,this.height=t.height??5,this.running=!1,this.delay=t.delay??0,this.maxSteps=t.max??1/0,this.onStart=t.onStart??(()=>{}),this.onStop=t.onStop??(()=>{}),this.onStep=t.onStep??(()=>{}),this.engine=t.engine,this.src=t.src,this.format=t.format??{html:!0},this.generator=t.generator??(e=>e.walk()),this.view={},this.view.parent=t.parent,this.view.main=p(t.parent,"div",{class:["eval-box"]})}start(t){this.running&&this.stop(),t!==void 0&&(this.src=t);try{this.expr=typeof t=="string"?this.engine.parse(t):t,this.seq=this.generator(this.expr)}catch(e){return this.stop(e.message)}return this.onStart(),this.running=!0,this.tick(),this}stop(t){this.running=!1,t&&this.print(t,{class:["error"],line:""}),this.onStop()}tick(){if(!this.running)return;let{value:t,done:e}=this.seq.next();if(t&&this.print(t.expr.format(this.format),{line:t.steps}),this.onStep(t,e||t.final),e||t.final)return this.view.last&&this.view.last.classList.add("success"),this.stop();if(t.steps>=this.maxSteps)return this.stop("Max steps reached: "+this.maxSteps);setTimeout(()=>this.tick(),this.delay)}remove(){this.view.parent&&(this.view.parent.removeChild(this.view.main),this.view.parent=null)}setHeight(t){this.height=t}print(t,e={}){let i=p(this.view.main,"div",e);if(this.view.last=i,e.raw)i.innerHTML=t;else for(p(i,"span",{class:["line-number"],content:e.line}),p(i,"span",{class:e.class??["line-text"],color:e.color,content:t});this.view.main.children.length>this.height;)this.view.main.removeChild(this.view.main.firstChild);return this.view.parent&&(this.view.parent.scrollTop=i.offsetTop),i}};b.exports={EvalBox:m}});var I=l((nt,C)=>{"use strict";var q="#expr:",{encode:S,decode:x}=d();function B(n,t){return q+S(t)+"?"+n.declare().map(e=>e.split("=").map(i=>S(i)).join("=")).join(";")}function F(n){let t=n.match(new RegExp("^"+q+"([^?]+)\\??(.*)$"));if(!t)return null;let e=x(t[1]),i=t[2]?t[2].split(";").map(s=>x(s)):[];return{expr:e,decls:i}}function J(n){let t=new URLSearchParams(n);if(t.has("code")||t.has("terms")){let e=t.get("code")??"",i=t.get("terms").split(",");console.log("Migrating old-style link to new-style hash, code =",e,"terms =",i);let s=i.map(r=>r.split(":").map(decodeURIComponent).join("=")).join(";");return"#expr:"+encodeURIComponent(e)+"?"+s}}C.exports={permalink:B,readlink:F,readOldLink:J}});var E=l((st,A)=>{var w=class{constructor(t){this.ns=t+":"}save(t,e){window.localStorage.setItem(this.ns+t,JSON.stringify(e))}load(t){return JSON.parse(window.localStorage.getItem(this.ns+t))}scan(){let t=window.localStorage,e=[];for(let i=0;i<t.length;i++){let s=t.key(i);s.startsWith(this.ns)&&e.push(s.substring(this.ns.length))}return e}delete(t){window.localStorage.removeItem(this.ns+t)}};A.exports={Store:w}});var R=l((rt,M)=>{"use strict";var v=class{constructor(t={}){if(this.onchange=[],this.check=t.check??(e=>!0),t.onchange&&this.onchange.push(t.onchange),t.storage){let[e,i]=t.storage;this.save=()=>e.save(i,this.value),this.load=()=>this.set(e.load(i)??t.default,!0)}else this.save=()=>{},this.load=()=>{this.set(t.default)};this.load()}set(t,e=!1){if(!this.check(t))throw new Error("SMCtl: invalid value "+t);for(let i of this.onchange)i(t,this.value);this.value=t,e||this.save(t)}get(){return this.value}addAction(t){this.onchange.push(t)}};M.exports={SMCtl:v}});var H=l((at,T)=>{"use strict";var{append:o}=d(),u=null,k=class{constructor(t,e={}){this.button=t,t.classList.add("hamburger-button"),this.parent=t.parentElement,this.hidden=!0,this.content=o(this.parent,"ul",{class:e.right?["hamburger","hamburger-right"]:["hamburger"]}),this.button.addEventListener("click",()=>this.toggle())}appendLi(){return o(this.content,"li")}addSeparator(){return this.appendLi().classList.add("hamburger-separator"),this}addLabel(t){let e=this.appendLi();return o(e,"span",{content:t}),this}addLink(t,e,i){i==="_blank"&&(t=t+" &#x1F517;");let s=this.appendLi(),r=o(s,"a",{content:t});return r.href=e,r.target=i,r.onclick=()=>this.hide(),this}addAction(t,e){let i=this.appendLi(),s=o(i,"a",{content:t});return s.onclick=()=>{e(),this.hide()},this}addChoice(t,e,i){let s=this.appendLi();o(s,"span",{content:t});let r={};for(let a of i){let c=Array.isArray(a)?a[1]:a,g=Array.isArray(a)?a[0]:a,f=o(s,"a",{content:g,class:["hamburger-choice"]});r[c]=f,f.onclick=()=>{e.set(c),this.hide()}}let h=(a,c)=>{c!==void 0&&r[c]&&r[c].classList.remove("hamburger-current"),r[a]&&r[a].classList.add("hamburger-current")};return e.addAction(h),h(e.get(),void 0),this}addFlags(t,e){let i={},s=this.appendLi();o(s,"span",{content:t});for(let[r,h]of e){let a=o(s,"a",{content:r,class:["hamburger-choice"]});a.onclick=()=>{h.set(!h.get()),this.hide()};let c=(g,f)=>{a.classList.toggle("hamburger-current",g)};h.addAction(c),c(h.get())}return this}hide(){return u===this&&(u=null),this.hidden=!0,this.content.style.display="none",!1}show(){return u&&u.hide(),u=this,this.hidden=!1,this.content.style.display="block",!1}toggle(){return this.hidden?this.show():this.hide(),!1}};T.exports={Hamburger:k}});var{grabView:N,append:P,sanitize:W,decode:_,encode:$}=d(),{EvalBox:D}=L(),{permalink:G,readlink:K,readOldLink:Q}=I(),{Store:X}=E(),{SMCtl:Y}=R(),{Hamburger:Z}=H();window.SMCtl=Y;window.Hamburger=Z;window.EvalBox=D;window.Store=X;window.append=P;window.grabView=N;window.sanitize=W;window.permalink=G;window.readlink=K;window.readOldLink=Q;window.decode=_;window.encode=$;})();
//# sourceMappingURL=util.min.js.map
