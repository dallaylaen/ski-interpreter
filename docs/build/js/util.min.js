"use strict";(()=>{var l=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports);var d=l((tt,b)=>{"use strict";function j(...s){let t={};for(let e of s)t[e]=document.getElementById(e);return t}function O(s,t,e={}){let n=document.createElement(t);return e.class&&n.classList.add(...e.class),e.content!==void 0&&(n.innerHTML=""+e.content),e.hidden&&(n.hidden=!0),e.color&&(n.style.color=e.color),s&&s.appendChild(n),n}function m(s,t){t(s);for(let e of s.childNodes)m(e,t)}function $(s){let t=document.createElement("div");if(t.innerHTML=s.replace(/^\s+|\s+$/gs,""),t.childNodes.length!==1)throw new Error("Custom HTML element must have exactly one root node");let e=t.childNodes[0],n={};return m(e,i=>{let r=i.getAttribute&&i.getAttribute("data-handle");if(r){if(n[r])throw new Error(`Duplicate data-handle attribute: ${r}`);n[r]=i}}),{...n,elem:e}}function B(s){let t=document.getElementById(s);if(!t)throw new Error(`Template not found: ${s}`);return t.innerHTML}function F(s){typeof s!="string"&&(s=""+s);let t={"<":"&lt;",">":"&gt;","&":"&amp;"};return s.replace(/[<>&]/g,e=>t[e])}function J(s){let t={"(":"%28",")":"%29"};return encodeURIComponent(s).replace(/[()]/g,e=>t[e]).replace(/%20/g,"+")}function z(s){return decodeURIComponent((""+s).replace(/\+/g," "))}b.exports={append:O,custom:$,decode:z,encode:J,grabView:j,sanitize:F,tpl:B,traverse:m}});var S=l((et,L)=>{"use strict";var{append:p}=d(),w=class{constructor(t={}){this.options=t,this.height=t.height??5,this.running=!1,this.delay=t.delay??0,this.maxSteps=t.max??1/0,this.onStart=t.onStart??(()=>{}),this.onStop=t.onStop??(()=>{}),this.onStep=t.onStep??(()=>{}),this.engine=t.engine,this.src=t.src,this.format=t.format??{html:!0},this.generator=t.generator??(e=>e.walk()),this.view={},this.view.parent=t.parent,this.view.scroll=t.scroll??t.parent,this.view.main=p(t.parent,"div",{class:["eval-box"]})}start(t){this.running&&this.stop(),t!==void 0&&(this.src=t);try{this.expr=typeof t=="string"?this.engine.parse(t):t,this.seq=this.generator(this.expr)}catch(e){return this.stop(e.message)}return this.onStart(),this.running=!0,this.tick(),this}stop(t){this.running=!1,t&&this.print(t,{class:["error"],line:""}),this.onStop()}tick(){if(!this.running)return;let{value:t,done:e}=this.seq.next();if(t&&this.print(t.expr.format(this.format),{line:t.steps}),this.onStep(t,e||t.final),e||t.final)return this.view.last&&this.view.last.classList.add("success"),this.stop();if(t.steps>=this.maxSteps)return this.stop("Max steps reached: "+this.maxSteps);setTimeout(()=>this.tick(),this.delay)}remove(){this.view.parent&&(this.view.parent.removeChild(this.view.main),this.view.parent=null)}setHeight(t){this.height=t}print(t,e={}){let n=p(this.view.main,"div",e);if(this.view.last=n,e.raw)n.innerHTML=t;else for(p(n,"span",{class:["line-number"],content:e.line}),p(n,"span",{class:e.class??["line-text"],color:e.color,content:t});this.view.main.children.length>this.height;)this.view.main.removeChild(this.view.main.firstChild);return this.view.scroll&&(this.view.scroll.scrollTop=n.offsetTop),n}};L.exports={EvalBox:w}});var A=l((nt,q)=>{"use strict";var E="#expr:",{encode:x,decode:C}=d();function D(s,t){return E+x(t)+"?"+s.declare().map(e=>e.split("=").map(n=>x(n)).join("=")).join(";")}function P(s){let t=s.match(new RegExp("^"+E+"([^?]+)\\??(.*)$"));if(!t)return null;let e=C(t[1]),n=t[2]?t[2].split(";").map(i=>C(i)):[];return{expr:e,decls:n}}function V(s){let t=new URLSearchParams(s);if(t.has("code")||t.has("terms")){let e=t.get("code")??"",n=t.get("terms").split(",");console.log("Migrating old-style link to new-style hash, code =",e,"terms =",n);let i=n.map(r=>r.split(":").map(decodeURIComponent).join("=")).join(";");return"#expr:"+encodeURIComponent(e)+"?"+i}}q.exports={permalink:D,readlink:P,readOldLink:V}});var T=l((st,I)=>{var v=class{constructor(t){this.ns=t+":"}save(t,e){window.localStorage.setItem(this.ns+t,JSON.stringify(e))}load(t){return JSON.parse(window.localStorage.getItem(this.ns+t))}scan(){let t=window.localStorage,e=[];for(let n=0;n<t.length;n++){let i=t.key(n);i.startsWith(this.ns)&&e.push(i.substring(this.ns.length))}return e}delete(t){window.localStorage.removeItem(this.ns+t)}};I.exports={Store:v}});var H=l((it,M)=>{"use strict";var k=class{constructor(t={}){if(this.onchange=[],this.check=t.check??(e=>!0),t.onchange&&this.onchange.push(t.onchange),t.storage){let[e,n]=t.storage;this.save=()=>e.save(n,this.value),this.load=()=>this.set(e.load(n)??t.default,!0)}else this.save=()=>{},this.load=()=>{this.set(t.default)};this.load()}set(t,e=!1){if(!this.check(t))throw new Error("SMCtl: invalid value "+t);for(let n of this.onchange)n(t,this.value);this.value=t,e||this.save(t)}get(){return this.value}addAction(t){this.onchange.push(t)}};M.exports={SMCtl:k}});var N=l((rt,R)=>{"use strict";var{append:o}=d(),u=null,y=class{constructor(t,e={}){this.button=t,t.classList.add("hamburger-button"),this.parent=t.parentElement,this.hidden=!0,this.content=o(this.parent,"ul",{class:e.right?["hamburger","hamburger-right"]:["hamburger"]}),this.button.addEventListener("click",()=>this.toggle())}appendLi(){return o(this.content,"li")}addSeparator(){return this.appendLi().classList.add("hamburger-separator"),this}addLabel(t){let e=this.appendLi();return o(e,"span",{content:t}),this}addLink(t,e,n){n==="_blank"&&(t=t+" &#x1F517;");let i=this.appendLi(),r=o(i,"a",{content:t});return r.href=e,r.target=n,r.onclick=()=>this.hide(),this}addAction(t,e){let n=this.appendLi(),i=o(n,"a",{content:t});return i.onclick=()=>{e(),this.hide()},this}addChoice(t,e,n){let i=this.appendLi();o(i,"span",{content:t});let r={};for(let a of n){let c=Array.isArray(a)?a[1]:a,f=Array.isArray(a)?a[0]:a,g=o(i,"a",{content:f,class:["hamburger-choice"]});r[c]=g,g.onclick=()=>{e.set(c),this.hide()}}let h=(a,c)=>{c!==void 0&&r[c]&&r[c].classList.remove("hamburger-current"),r[a]&&r[a].classList.add("hamburger-current")};return e.addAction(h),h(e.get(),void 0),this}addFlags(t,e){let n={},i=this.appendLi();o(i,"span",{content:t});for(let[r,h]of e){let a=o(i,"a",{content:r,class:["hamburger-choice"]});a.onclick=()=>{h.set(!h.get()),this.hide()};let c=(f,g)=>{a.classList.toggle("hamburger-current",f)};h.addAction(c),c(h.get())}return this}hide(){return u===this&&(u=null),this.hidden=!0,this.content.style.display="none",!1}show(){return u&&u.hide(),u=this,this.hidden=!1,this.content.style.display="block",!1}toggle(){return this.hidden?this.show():this.hide(),!1}};R.exports={Hamburger:y}});var U=d(),{EvalBox:W}=S(),{permalink:_,readlink:G,readOldLink:K}=A(),{Store:Q}=T(),{SMCtl:X}=H(),{Hamburger:Y}=N();window.SMCtl=X;window.Hamburger=Y;window.EvalBox=W;window.Store=Q;window.append=U.append;window.util={...U,permalink:_,readlink:G,readOldLink:K};})();
//# sourceMappingURL=util.min.js.map
